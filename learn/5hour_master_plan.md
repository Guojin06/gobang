# 5小时高效掌握在线五子棋项目

## 总体策略
- **从全局到细节**：先理解整体架构，再深入核心模块
- **理论+实践**：每学一个模块立即写代码验证
- **重点突出**：80%时间专注核心业务逻辑，20%时间了解基础设施

---

## 第1小时：项目全貌与架构理解
**目标**：快速建立项目认知框架

### 前30分钟：整体架构梳理
1. **服务器架构**（`server.hpp`）
   - WebSocket服务器 + HTTP接口
   - 路由分发：`/reg`、`/login`、`/info`、`/hall`、`/room`
   - 会话管理：Cookie + Session

2. **核心业务流程**
   ```
   用户注册/登录 → 进入大厅 → 匹配对手 → 创建房间 → 对局游戏
   ```

3. **模块依赖关系**
   ```
   server.hpp (主控制器)
   ├── session.hpp (会话管理)
   ├── online.hpp (在线状态)
   ├── matcher.hpp (匹配系统)
   ├── room.hpp (房间管理)
   ├── db.hpp (数据库)
   └── util.hpp (工具函数)
   ```

### 后30分钟：前端界面体验
1. 启动服务器：`cd source && ./gobang`
2. 访问 `http://localhost:8080`
3. 体验完整流程：注册 → 登录 → 大厅 → 匹配
4. 理解前后端交互协议

---

## 第2小时：核心业务模块深度学习
**目标**：掌握matcher.hpp和room.hpp核心逻辑

### 前30分钟：匹配系统（`matcher.hpp`）
1. **关键概念**：
   - 3个匹配队列：普通、高手、大神（按天梯分数）
   - 线程安全的阻塞队列
   - 自动匹配：≥2人时自动配对

2. **核心语法**：
   - 模板类：`template<class T> class match_queue`
   - 条件变量：`std::condition_variable`
   - 线程：`std::thread`

3. **练习**：写一个简化的匹配队列

### 后30分钟：房间系统（`room.hpp`）
1. **关键概念**：
   - 房间生命周期：创建 → 游戏 → 结束 → 销毁
   - 游戏状态机：等待、游戏中、结束
   - 广播机制：同步游戏状态给双方

2. **核心语法**：
   - 状态枚举：`enum room_statu`
   - 智能指针：`room_ptr`
   - JSON消息处理

---

## 第3小时：通信与会话机制
**目标**：理解WebSocket通信和会话管理

### 前30分钟：WebSocket通信机制
1. **协议理解**：
   - HTTP升级到WebSocket
   - 双向实时通信
   - 消息格式：JSON

2. **代码分析**：
   - `server.hpp`中的回调函数
   - `wsopen_callback`、`wsmsg_callback`、`wsclose_callback`

### 后30分钟：会话管理（`session.hpp`）
1. **核心概念**：
   - Session生命周期管理
   - 定时器控制：临时/永久
   - 线程安全操作

2. **练习**：实现简化版Session管理器

---

## 第4小时：数据层与工具函数
**目标**：掌握数据库操作和基础工具

### 前30分钟：数据库操作（`db.hpp`）
1. **表结构**（`db.sql`）：
   - 用户表：id、用户名、密码、分数、胜场、总场数
   
2. **操作接口**：
   - 注册：`insert()`
   - 登录验证：`login()`
   - 更新战绩：`win()`、`lose()`

### 后30分钟：工具函数（`util.hpp`）
1. **JSON处理**：序列化/反序列化
2. **字符串工具**：分割、处理
3. **文件操作**：读取静态资源
4. **练习**：写JSON处理小程序

---

## 第5小时：实战演练与总结
**目标**：动手实践，查漏补缺

### 前30分钟：代码实战
1. 修改匹配逻辑（如改变分数阈值）
2. 添加新的API接口
3. 调试运行，验证理解

### 后30分钟：项目总结与面试准备
1. **画系统架构图**
2. **整理技术亮点**：
   - 多线程匹配队列
   - WebSocket双向通信
   - 会话生命周期管理
   - 线程安全设计
3. **准备面试问答**

---

## 实践建议

### 必做练习
1. **第2小时**：实现简化匹配队列
2. **第3小时**：实现Session管理demo
3. **第4小时**：JSON序列化练习
4. **第5小时**：添加一个新功能

### 学习工具
- 在线C++编译器：验证语法
- 画图工具：绘制架构图
- 抓包工具：观察网络协议

### 注意事项
- 遇到不懂的语法立即查cppreference
- 每个模块学完立即写总结
- 重点理解模块间的协作关系
- 记录面试可能问到的技术点

---

## 成果检验
学完后你应该能够：
1. 说清楚从用户登录到开始对局的完整流程
2. 解释关键技术：线程安全、WebSocket、Session管理
3. 独立添加一个小功能
4. 回答面试官关于项目架构的问题
